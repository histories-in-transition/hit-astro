---
import PageLayout from "@/layouts/page-layout.astro";
import TableHead from "@/components/table-head.astro";
import TabulatorTable from "@/components/tabulator-table.svelte";
import { scribesTableConfig } from "@/lib/tabulator-table-configs.js";
import scribes from "@/content/data/scribes.json";

import MapLeaflet from "@/components/map-leaflet.svelte";
import { processScribesData } from "@/lib/make-geojson.ts";
const geoJsonData = processScribesData(scribes);

// Transform data and prepare columns for Tabulator Table
const tableData = scribesTableConfig.transformData(scribes);
const columns = scribesTableConfig.getColumns();
const rowClickConfig = scribesTableConfig.getRowClickConfig;
---

<PageLayout title="Schreiber">
	<TableHead
		title="Schreiber"
		definition="Liste aller Schreiber (einzeln oder als Gruppe erfasst), deren HÃ¤nde in mehr als einer Handschrift nachgewiesen werden konnten."
	>
		<MapLeaflet client:only="svelte" geoJsonData={geoJsonData} />
		<TabulatorTable
			client:only="svelte"
			data={tableData}
			columns={columns}
			tableId="scribes-table"
			downloadTitle="hit_scribes"
			rowClickConfig={rowClickConfig}
			updateMapOnFilter={true}
			mapIdField="hit_id"
		/>
	</TableHead>
</PageLayout>
